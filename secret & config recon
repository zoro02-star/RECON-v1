#!/bin/bash
#What this script can realistically find
#✔ API keys (Stripe, AWS, Firebase)
#✔ Internal API routes
#✔ Feature flags
#✔ Debug configs
#✔ Source maps
#✔ Hardcoded secrets

set -euo pipefail

if [ -z "${1:-}" ]; then
    echo "Usage: $0 domain.com"
    exit 1
fi

TARGET=$1
OUTDIR="$TARGET/js-recon"
HTTPX="$HOME/go/bin/httpx"
GAU="$HOME/go/bin/gau"

mkdir -p "$OUTDIR"

echo "[+] Collecting JS URLs"
$GAU "$TARGET" \
  | grep -Ei "\.js(\?|$)" \
  | grep -Ev "jquery|bootstrap|google-analytics|gtag|cloudflare|doubleclick" \
  | sort -u > "$OUTDIR/js_urls.txt"

echo "[+] Checking live JS files"
$HTTPX -l "$OUTDIR/js_urls.txt" \
  -mc 200 \
  -mime application/javascript,text/javascript \
  -silent \
  -o "$OUTDIR/live_js.txt"

echo "[+] Running nuclei exposure templates"
nuclei -l "$OUTDIR/live_js.txt" \
  -t exposures/ \
  -severity medium,high,critical \
  -o "$OUTDIR/nuclei_js.txt"

echo "[✓] JS recon completed for $TARGET"



